@page
@model ContactModel
@{
    ViewData["Title"] = "Contact";
}
<h2>@ViewData["Title"]</h2>
<h3>@Model.Message</h3>

<head>
    <style>
        table, th, td {
            border: 1px solid black;
            width: 100%;
            padding: 15px;
        }
    </style>
</head>
<body>
    @if (Program.Globals.alerttext != "")
    {
        <script language="javascript">
        alert('@Program.Globals.alerttext');
        </script>
        Program.Globals.alerttext = "";
    }

    @if (Program.Globals.racenametable != "")
    {<label for="table1">List of racers: </label>
        <table id="table1">
            <tr>
                <th>Racer Name</th>
                <th>Boat Name</th>
                <th>Boat Number</th>
                <th>Crew?</th>
            </tr>
            @try
            {
                @foreach (SailingWeb.Data.BoatsRacing boat in SQL.GetRacers(Program.Globals.racenametable))
                {
                    <tr>
                        <td>@boat.name</td>
                        <td>@boat.boat</td>
                        <td>@boat.boatNumber</td>
                        <td>@boat.crew</td>
                    </tr>

                }
            }
            catch
            {
                Program.Globals.alerttext = "The race does not exist.";


            }

        </table>
    }
    <label for="table2">List of events: </label>
    <form method="post">
        @if (SQL.todaysevent().Count == 0)
        {
            <p1>I'm afraid there is no race on today.</p1>

        }
        else if (Program.Globals.racenametable == "")
        {

            <select asp-for="race">
                @foreach (var race in SQL.todaysevent())
                {
                    <option value="@race">@race</option>
                }
            </select>

        }
        <input type="submit" value="Submit" />
        <input type="submit" value="Enter calendar into database?" />
    </form>
    <table id="table2">
        <tr>
            <th>Event Name</th>
            <th>Event notes</th>
            <th>Event date/time</th>
        </tr>

        @for (int i = 0; i < Program.Globals.Event1.Items.Count; i++)
        {
            try
            {

                @if (Program.Globals.Event1.Items[i].Summary != null)
                {
                    if (Convert.ToDateTime(Program.Globals.Event1.Items[i].Start.Date).Year >= 2018)
                    {
                        <tr>



                            <td> @Program.Globals.Event1.Items[i].Summary </td>
                            <td>@Program.Globals.Event1.Items[i].Description</td>
                            @if (Program.Globals.Event1.Items[i].Start.Date != null)
                            {
                                <td> @Program.Globals.Event1.Items[i].Start.Date</td>
                            }

                            else if (Program.Globals.Event1.Items[i].Start.DateTime.HasValue)
                            {
                                <td> @Program.Globals.Event1.Items[i].Start.DateTime.Value.Date</td>
                            }
                            else
                            {

                                <td> null entry </td>
                                <td> null entry </td>
                                <td> null entry </td>
                            }

                        </tr>
                    }
                    else
                    {
                        throw new InsufficientExecutionStackException();
                    }
                }
                else
                {
                    <tr>

                        <td> null entry </td>
                        <td> null entry </td>
                        <td> null entry </td>
                    </tr>

                }



            }
            catch
            {

                @if (Program.Globals.Event1.Items[i].Summary != null)
                {
                    if (Program.Globals.Event1.Items[i].Start.DateTime.Value.Year >= 2018)
                    {
                        <tr>



                            <td> @Program.Globals.Event1.Items[i].Summary </td>
                            <td>@Program.Globals.Event1.Items[i].Description</td>
                            @if (Program.Globals.Event1.Items[i].Start.Date != null)
                            {
                                <td> @Program.Globals.Event1.Items[i].Start.Date</td>
                            }

                            else if (Program.Globals.Event1.Items[i].Start.DateTime.HasValue)
                            {
                                <td> @Program.Globals.Event1.Items[i].Start.DateTime.Value.Date</td>
                            }


                        </tr>
                    }
                }
                else
                {
                    <tr>

                        <td> null entry </td>
                        <td> null entry </td>
                        <td> null entry </td>
                    </tr>
                }



            }
        }


    </table>

</body>

